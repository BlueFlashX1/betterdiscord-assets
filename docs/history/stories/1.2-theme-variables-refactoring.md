# Story 1.2: Theme Variables Refactoring

**Phase:** 1 - Development Infrastructure
**Priority:** High
**Effort:** Medium
**Status:** In Progress

---

## Story

As a theme developer, I want a modular variable system with semantic component tokens so that I can easily maintain the theme, create variants, and reuse patterns across different theme versions.

---

## Context

The current Solo Leveling theme has 4,467 lines with well-organized CSS variables, but all variables are in a single file. To improve maintainability and enable theme variants (different color schemes, light mode, etc.), we need to refactor into a modular component-based system with semantic design tokens.

---

## Acceptance Criteria

### Modular File Structure

- [ ] Create `variables/` directory for all variable files
- [ ] Separate variables into semantic modules:
  - `_colors.css` - Color palette
  - `_effects.css` - Glows, shadows, transitions
  - `_typography.css` - Fonts, text styles
  - `_spacing.css` - Radii, spacing
  - `_components.css` - Component-specific tokens
- [ ] Create main `variables.css` that imports all modules
- [ ] Update theme to import from modular structure

### Semantic Design Tokens

- [ ] Primary colors → `--sl-color-primary-*`
- [ ] Status colors → `--sl-color-status-*`
- [ ] Effect tokens → `--sl-effect-glow-*`, `--sl-effect-shadow-*`
- [ ] Component tokens → `--sl-comp-button-*`, `--sl-comp-card-*`
- [ ] Naming convention follows: `--sl-[category]-[property]-[variant]`

### Component-Based Patterns

- [ ] Button patterns (primary, secondary, danger)
- [ ] Card patterns (default, hover, selected)
- [ ] Input patterns (default, focus, error)
- [ ] Status indicator patterns
- [ ] Navigation patterns

### Theme Variants Support

- [ ] Base variable structure supports theme variants
- [ ] Dark mode variables (current)
- [ ] Light mode variables (future)
- [ ] High contrast mode (future)
- [ ] Variables organized for easy color scheme swaps

### Documentation

- [ ] Variable naming convention documented
- [ ] Component token usage examples
- [ ] How to create theme variants guide
- [ ] Migration guide from current structure

---

## Technical Implementation

### Directory Structure

```
themes/
├── SoloLeveling-ClearVision.theme.css (main theme)
├── variables/
│   ├── variables.css                (imports all modules)
│   ├── _colors.css                  (color palette)
│   ├── _effects.css                 (glows, shadows, transitions)
│   ├── _typography.css              (fonts, text styles)
│   ├── _spacing.css                 (radii, spacing)
│   └── _components.css              (component tokens)
└── backups/
    └── SoloLeveling-ClearVision.theme.css.backup-YYYYMMDD-HHMMSS
```

### Variables Module: \_colors.css

```css
/**
 * Solo Leveling - Color Palette
 * Semantic color tokens for the Solo Leveling theme
 */

:root {
  /* ===== PRIMARY COLORS ===== */
  --sl-color-primary: #8a2be2; /* Blue Violet */
  --sl-color-primary-hover: #ba55d3; /* Medium Orchid */
  --sl-color-primary-rgb: 138, 43, 226; /* RGB values for alpha */

  /* ===== ACCENT COLORS ===== */
  --sl-color-accent-purple-light: #a78bfa;
  --sl-color-accent-purple-medium: #8b5cf6;
  --sl-color-accent-purple-dark: #7c3aed;

  /* ===== STATUS COLORS ===== */
  --sl-color-status-success: #00ff88;
  --sl-color-status-warning: #ffaa00;
  --sl-color-status-danger: #ff4444;
  --sl-color-status-info: #8a2be2;

  /* ===== USER STATUS ===== */
  --sl-color-online: var(--sl-color-status-success);
  --sl-color-idle: var(--sl-color-status-warning);
  --sl-color-dnd: #ff0000;
  --sl-color-streaming: var(--sl-color-primary);
  --sl-color-offline: #8b7fa8;

  /* ===== BACKGROUND COLORS ===== */
  --sl-color-bg-dark: rgba(10, 10, 15, 1);
  --sl-color-bg-surface: rgba(15, 15, 25, 1);
  --sl-color-bg-elevated: rgba(20, 20, 30, 1);

  /* ===== TEXT COLORS ===== */
  --sl-color-text-primary: rgba(255, 255, 255, 0.95);
  --sl-color-text-secondary: rgba(255, 255, 255, 0.75);
  --sl-color-text-tertiary: rgba(255, 255, 255, 0.55);
  --sl-color-text-muted: rgba(255, 255, 255, 0.35);
}
```

### Variables Module: \_effects.css

```css
/**
 * Solo Leveling - Visual Effects
 * Reusable glow, shadow, and transition patterns
 */

:root {
  /* ===== GLOW EFFECTS ===== */
  --sl-effect-glow-subtle: 0 0 4px rgba(var(--sl-color-primary-rgb), 0.1);
  --sl-effect-glow-light: 0 0 6px rgba(var(--sl-color-primary-rgb), 0.15);
  --sl-effect-glow-medium: 0 0 8px rgba(var(--sl-color-primary-rgb), 0.2);
  --sl-effect-glow-strong: 0 0 10px rgba(var(--sl-color-primary-rgb), 0.25);
  --sl-effect-glow-intense: 0 0 14px rgba(var(--sl-color-primary-rgb), 0.4);
  --sl-effect-glow-extreme: 0 0 28px rgba(var(--sl-color-primary-rgb), 0.4);

  /* ===== TEXT SHADOWS ===== */
  --sl-effect-text-shadow-subtle: 0 0 3px rgba(0, 0, 0, 0.28);
  --sl-effect-text-shadow-medium: 0 0 6px rgba(var(--sl-color-primary-rgb), 0.25);
  --sl-effect-text-shadow-strong: 0 0 8px rgba(var(--sl-color-primary-rgb), 0.4);
  --sl-effect-text-shadow-dark: 0 1px 1px rgba(0, 0, 0, 0.28);

  /* ===== BOX SHADOWS ===== */
  --sl-effect-shadow-card: 0 10px 26px rgba(0, 0, 0, 0.34);
  --sl-effect-shadow-card-hover: 0 12px 30px rgba(0, 0, 0, 0.38);
  --sl-effect-shadow-modal: 0 16px 40px rgba(0, 0, 0, 0.46);

  /* ===== TRANSITIONS ===== */
  --sl-effect-transition-fast: all 0.15s ease;
  --sl-effect-transition-normal: all 0.2s ease;
  --sl-effect-transition-slow: all 0.3s ease;
  --sl-effect-transition-bounce: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  --sl-effect-transition-glow: box-shadow 0.2s ease;
}
```

### Variables Module: \_components.css

```css
/**
 * Solo Leveling - Component Tokens
 * Semantic tokens for UI components
 */

:root {
  /* ===== BUTTON COMPONENT ===== */
  --sl-comp-button-bg-primary: var(--sl-color-primary);
  --sl-comp-button-bg-primary-hover: var(--sl-color-primary-hover);
  --sl-comp-button-shadow-primary: var(--sl-effect-glow-medium);
  --sl-comp-button-shadow-primary-hover: var(--sl-effect-glow-strong);
  --sl-comp-button-radius: var(--sl-spacing-radius-control);
  --sl-comp-button-transition: var(--sl-effect-transition-normal);

  /* ===== CARD COMPONENT ===== */
  --sl-comp-card-bg: var(--sl-color-bg-surface);
  --sl-comp-card-bg-hover: var(--sl-color-bg-elevated);
  --sl-comp-card-border: var(--sl-effect-border-purple-subtle);
  --sl-comp-card-shadow: var(--sl-effect-shadow-card);
  --sl-comp-card-shadow-hover: var(--sl-effect-shadow-card-hover);
  --sl-comp-card-radius: var(--sl-spacing-radius-surface);

  /* ===== INPUT COMPONENT ===== */
  --sl-comp-input-bg: rgba(0, 0, 0, 0.2);
  --sl-comp-input-bg-focus: rgba(0, 0, 0, 0.3);
  --sl-comp-input-border: var(--sl-effect-border-purple-subtle);
  --sl-comp-input-border-focus: var(--sl-effect-border-purple-medium);
  --sl-comp-input-shadow-focus: var(--sl-effect-glow-medium);

  /* ===== CHANNEL COMPONENT ===== */
  --sl-comp-channel-bg-selected: var(--sl-color-primary);
  --sl-comp-channel-text-selected: var(--sl-color-text-primary);
  --sl-comp-channel-text-unread: var(--sl-color-primary);
  --sl-comp-channel-glow-selected: var(--sl-effect-glow-medium);
}
```

### Migration Strategy

**Phase 1: Extract Variables (Current)**

1. Create `variables/` directory
2. Split current variables into modular files
3. Create semantic naming system
4. Maintain backward compatibility

**Phase 2: Update Theme**

1. Import modular variables
2. Replace hardcoded values with component tokens
3. Test all UI elements
4. Verify no visual regressions

**Phase 3: Documentation**

1. Document variable naming convention
2. Create component token usage guide
3. Write theme variant creation guide

---

## Usage Examples

### Before (Current)

```css
.button-primary {
  background: #8a2be2;
  box-shadow: 0 0 8px rgba(139, 92, 246, 0.2);
  border-radius: 8px;
  transition: all 0.2s ease;
}

.button-primary:hover {
  background: #ba55d3;
  box-shadow: 0 0 10px rgba(139, 92, 246, 0.25);
}
```

### After (With Component Tokens)

```css
.button-primary {
  background: var(--sl-comp-button-bg-primary);
  box-shadow: var(--sl-comp-button-shadow-primary);
  border-radius: var(--sl-comp-button-radius);
  transition: var(--sl-comp-button-transition);
}

.button-primary:hover {
  background: var(--sl-comp-button-bg-primary-hover);
  box-shadow: var(--sl-comp-button-shadow-primary-hover);
}
```

### Benefits

- Single source of truth for component styling
- Easy to create theme variants (just swap color palette)
- Consistent patterns across entire theme
- Self-documenting with semantic names

---

## Testing Requirements

- [ ] Visual regression testing on all UI components
- [ ] Verify variables load correctly
- [ ] Test theme in different Discord contexts (servers, DMs, settings)
- [ ] Validate CSS variable fallbacks
- [ ] Performance testing (no load time increase)

---

## Success Metrics

- All variables extracted to modular files
- Zero visual regressions
- Component tokens used in 80%+ of theme
- Documentation complete
- Theme file size unchanged or smaller

---

## Related Stories

- Story 1.1: Plugin Template System
- Story 2.1: Live Preview System
- Future: Light Mode Variant
- Future: High Contrast Variant

---

**Created:** 2025-12-21
**Started:** 2025-12-21
**Estimated Completion:** 3 days
