{
  "title": "BetterDiscord Broken Symlink Issue and Fix",
  "description": "Documentation of why BetterDiscord stopped working after moving plugin files to archive, and how broken symlinks were fixed",
  "content": "# BetterDiscord Broken Symlink Issue and Fix\n\n> **Note**: Replace `$BETTERDISCORD_DEV` with your actual BetterDiscord development directory path (e.g., `$HOME/Documents/DEVELOPMENT/betterdiscord-dev` or `/path/to/your/betterdiscord-dev`)\n\n## Problem Summary\n\nBetterDiscord stopped working properly after moving plugin files (`CriticalHit.plugin.js` and `CriticalHitAnimation.plugin.js`) to an archive folder. The application was likely failing to load plugins or experiencing errors.\n\n## Root Cause\n\n**Broken Symlinks**: When plugin files were moved from the development folder to the archive folder, the symlinks in BetterDiscord's plugins directory (`~/Library/Application Support/BetterDiscord/plugins/`) were left pointing to files that no longer existed.\n\n### Technical Details\n\n- **Location**: `~/Library/Application Support/BetterDiscord/plugins/`\n- **Broken Symlinks**:\n  - `CriticalHit.plugin.js` → `$BETTERDISCORD_DEV/plugins/CriticalHit.plugin.js` (file moved to archive)\n  - `CriticalHitAnimation.plugin.js` → `$BETTERDISCORD_DEV/plugins/CriticalHitAnimation.plugin.js` (file moved to archive)\n- **Impact**: BetterDiscord couldn't load these plugins, potentially causing:\n  - Plugin loading failures\n  - Error messages in console\n  - BetterDiscord instability\n  - Support library conflicts\n\n## Solution\n\n### Step 1: Identify Broken Symlinks\n\n```bash\ncd ~/Library/Application\\ Support/BetterDiscord/plugins\nfind . -type l -name \"*.plugin.js\" -exec sh -c 'test ! -e \"$1\" && echo \"Broken: $1 -> $(readlink \"$1\")\"' _ {} \\;\n```\n\n### Step 2: Remove Broken Symlinks\n\n```bash\ncd ~/Library/Application\\ Support/BetterDiscord/plugins\nrm -f CriticalHit.plugin.js CriticalHitAnimation.plugin.js\n```\n\n### Step 3: Verify Support Libraries\n\nConfirmed that support libraries were **NOT** affected:\n- ✅ ZeresPluginLibrary v2.0.23 - File exists and enabled\n- ✅ BDFDB v4.3.7 - File exists and enabled\n- ✅ All config files valid\n\n### Step 4: Create New Symlink (Optional)\n\nCreated symlink for merged plugin:\n```bash\ncd ~/Library/Application\\ Support/BetterDiscord/plugins\nln -sf $BETTERDISCORD_DEV/plugins/CriticalHitMerged.plugin.js CriticalHitMerged.plugin.js\n```\n\n## Prevention Pattern\n\n**When moving plugin files:**\n\n1. **Always check for symlinks** before moving files:\n   ```bash\n   find ~/Library/Application\\ Support/BetterDiscord/plugins -type l -name \"*.plugin.js\"\n   ```\n\n2. **Remove symlinks first**, then move files:\n   ```bash\n   # Remove symlinks\n   rm ~/Library/Application\\ Support/BetterDiscord/plugins/PluginName.plugin.js\n   # Then move files\n   mv source/PluginName.plugin.js archive/\n   ```\n\n3. **Or update symlinks** if files are moved:\n   ```bash\n   # Remove old symlink\n   rm ~/Library/Application\\ Support/BetterDiscord/plugins/PluginName.plugin.js\n   # Create new symlink pointing to new location\n   ln -sf $BETTERDISCORD_DEV/new/path/PluginName.plugin.js ~/Library/Application\\ Support/BetterDiscord/plugins/\n   ```\n\n4. **Verify symlinks after moving**:\n   ```bash\n   find ~/Library/Application\\ Support/BetterDiscord/plugins -type l -exec sh -c 'test -e \"$1\" && echo \"✓ $1\" || echo \"✗ $1 (broken)\"' _ {} \\;\n   ```\n\n## Key Learnings\n\n1. **Symlinks are fragile**: Moving target files breaks symlinks automatically\n2. **BetterDiscord is sensitive**: Broken symlinks can cause plugin loading failures\n3. **Support libraries unaffected**: Core libraries (ZeresPluginLibrary, BDFDB) were not impacted\n4. **Always verify**: Check symlink validity after file operations\n\n## Related Files\n\n- BetterDiscord plugins folder: `~/Library/Application Support/BetterDiscord/plugins/`\n- Development plugins: `$BETTERDISCORD_DEV/plugins/`\n- Archive folder: `$BETTERDISCORD_DEV/archive/`\n- Config file: `~/Library/Application Support/BetterDiscord/data/stable/plugins.json`\n\n## Verification Commands\n\n```bash\n# Check all symlinks\nfind ~/Library/Application\\ Support/BetterDiscord/plugins -type l -exec sh -c 'echo \"$1 -> $(readlink \"$1\")\"; test -e \"$1\" && echo \"  ✓ Valid\" || echo \"  ✗ Broken\"' _ {} \\;\n\n# Check support libraries\nls -lh ~/Library/Application\\ Support/BetterDiscord/plugins/0PluginLibrary.plugin.js\nls -lh ~/Library/Application\\ Support/BetterDiscord/plugins/0BDFDB.plugin.js\n\n# Verify config\ncat ~/Library/Application\\ Support/BetterDiscord/data/stable/plugins.json | python3 -m json.tool\n```\n\n## Status After Fix\n\n- ✅ All symlinks valid\n- ✅ Support libraries working\n- ✅ Config files valid\n- ✅ BetterDiscord functioning normally\n- ✅ CriticalHitMerged plugin symlinked and ready",
  "tags": [
    "betterdiscord",
    "symlinks",
    "debugging",
    "file-management",
    "plugins",
    "troubleshooting",
    "macos"
  ],
  "files": [
    "betterdiscord-dev/plugins/CriticalHitMerged.plugin.js",
    "betterdiscord-dev/archive/CriticalHit.plugin.js",
    "betterdiscord-dev/archive/CriticalHitAnimation.plugin.js"
  ],
  "related": [
    "BetterDiscord plugin development",
    "Symlink management",
    "File organization patterns"
  ],
  "context": {
    "problem": "BetterDiscord stopped working after moving plugin files to archive",
    "root_cause": "Broken symlinks pointing to moved files",
    "solution": "Removed broken symlinks and verified support libraries",
    "prevention": "Always check and update symlinks when moving plugin files",
    "impact": "BetterDiscord plugin loading failures",
    "severity": "Medium - caused application instability",
    "resolution_time": "Immediate fix after identification"
  },
  "timestamp": "2025-12-02T02:14:00Z"
}
